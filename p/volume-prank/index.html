<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<meta name="theme-color" content="#0f0f10" />
<title>Volume</title>
<meta name="description" content="Adjust volume..." />
<style>
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
  background:#0f0f10;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding:12px 12px calc(12px + env(safe-area-inset-bottom));
}
.card{
  width:min(520px,95vw);
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.10);
  border-radius:20px;
  padding:14px;
  box-shadow:0 18px 70px rgba(0,0,0,.55);
}
h1{margin:0;font-size:18px;font-weight:950}
p{margin:8px 0 0;color:rgba(255,255,255,.72);font-size:13px;line-height:1.35}
.box{
  margin-top:14px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.28);
  border-radius:16px;
  padding:14px;
}
.row{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
.badge{
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  padding:6px 10px;
  border-radius:999px;
  font-weight:900;
  font-size:12px;
}
.sliderWrap{margin-top:12px; position:relative; height:54px;}
.track{
  position:absolute; left:0; right:0; top:24px;
  height:8px;border-radius:999px;
  background:rgba(255,255,255,.10);
}
.fill{
  position:absolute; left:0; top:24px; height:8px;border-radius:999px;
  background:linear-gradient(135deg,#3a82f7,#7c3aed);
  width:40%;
}
.knob{
  position:absolute; top:16px;
  width:26px;height:26px;border-radius:999px;
  background:#fff;
  box-shadow:0 10px 30px rgba(0,0,0,.4);
  transform:translateX(-50%);
  left:40%;
  touch-action:none;
}
.hint{
  margin-top:10px;
  color:rgba(255,255,255,.72);
  font-size:12px;
  text-align:center;
}
.btnRow{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
.btn{
  flex:1; min-width:150px;
  border:none; border-radius:12px;
  padding:11px 12px;
  font-weight:900;
  cursor:pointer;
}
.primary{background:linear-gradient(135deg,#3a82f7,#7c3aed);color:#fff}
.ghost{background:rgba(255,255,255,.08);color:#fff;border:1px solid rgba(255,255,255,.14)}
.pop{
  margin-top:10px;
  text-align:center;
  font-weight:950;
  display:none;
}
.pop.show{display:block;}
.smallNote{
  margin-top:10px;
  text-align:center;
  font-size:12px;
  color:rgba(255,255,255,.58);
  line-height:1.35;
}
</style>
</head>
<body>
<div class="card">
  <h1>Volume Settings</h1>
  <p>Turn the volume down to <b>0%</b>. (Should be easyâ€¦)</p>

  <div class="box">
    <div class="row">
      <div class="badge" id="pct">40%</div>
      <div class="badge" id="soundState">ðŸ”Š Sound ON</div>
    </div>

    <div class="sliderWrap" id="sw">
      <div class="track"></div>
      <div class="fill" id="fill"></div>
      <div class="knob" id="knob" aria-label="slider"></div>
    </div>

    <div class="hint" id="hint">Drag to 0%â€¦</div>
    <div class="pop" id="pop">ðŸ˜‚ GOT YOU</div>
    <div class="smallNote">Tip: If you canâ€™t hear anything, tap once to enable sound.</div>

    <div class="btnRow">
      <button class="btn ghost" id="reset">Reset</button>
      <button class="btn primary" id="menu">Back to menu</button>
    </div>
  </div>
</div>

<script>
const MAIN_PAGE_URL="https://xstajayx.github.io/message-media-space/";

const sw=document.getElementById("sw");
const knob=document.getElementById("knob");
const fill=document.getElementById("fill");
const pct=document.getElementById("pct");
const hint=document.getElementById("hint");
const pop=document.getElementById("pop");
const soundState=document.getElementById("soundState");

let dragging=false;

// slider value shown (0..1), but we will NEVER allow actual audio gain to hit 0
let value=0.40;

// ===== WebAudio constant sound (starts on first user gesture) =====
let audioCtx=null, osc=null, gainNode=null, started=false;

// minimum audible volume (the prank)
const MIN_GAIN = 0.08; // cannot reach silence

function clamp(v,a,b){ return Math.max(a, Math.min(b,v)); }

function initAudio(){
  if(started) return;
  started=true;

  try{
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    gainNode = audioCtx.createGain();
    gainNode.gain.value = MIN_GAIN;

    // slightly annoying tone (not painful)
    osc = audioCtx.createOscillator();
    osc.type = "square";
    osc.frequency.value = 520;

    // tiny wobble (adds irritation)
    const lfo = audioCtx.createOscillator();
    lfo.type = "sine";
    lfo.frequency.value = 6;

    const lfoGain = audioCtx.createGain();
    lfoGain.gain.value = 35; // freq wobble amount

    lfo.connect(lfoGain);
    lfoGain.connect(osc.frequency);

    osc.connect(gainNode);
    gainNode.connect(audioCtx.destination);

    lfo.start();
    osc.start();

    soundState.textContent = "ðŸ”Š Sound ON";
  }catch(e){
    soundState.textContent = "ðŸ”‡ Sound blocked";
  }
}

function render(){
  knob.style.left = (value*100)+"%";
  fill.style.width = (value*100)+"%";
  pct.textContent = Math.round(value*100)+"%";

  // Map slider to audio gain but clamp to MIN_GAIN
  if(gainNode){
    const target = clamp(value, 0, 1);
    const g = Math.max(MIN_GAIN, target * 0.9); // never 0
    gainNode.gain.value = g;
  }

  // when they think they hit 0, reveal
  if(Math.round(value*100) <= 1){
    pop.classList.add("show");
    hint.textContent = "Why wonâ€™t it go silent ðŸ˜­";
  }else{
    pop.classList.remove("show");
  }
}

function setFromX(clientX){
  const r=sw.getBoundingClientRect();
  let v=(clientX-r.left)/r.width;
  v = clamp(v, 0, 1);

  // prank behaviour: near 0 it "sticks" above 0 a bit
  if(v < 0.05){
    v = 0.01 + Math.random()*0.02; // appears almost 0 but not quite
  }

  value=v;
  render();
}

knob.addEventListener("pointerdown", (e)=>{
  initAudio();
  dragging=true;
  knob.setPointerCapture(e.pointerId);
},{passive:true});

knob.addEventListener("pointermove", (e)=>{
  if(!dragging) return;
  setFromX(e.clientX);
},{passive:true});

knob.addEventListener("pointerup", ()=>{
  dragging=false;
},{passive:true});

sw.addEventListener("pointerdown", (e)=>{
  initAudio();
  setFromX(e.clientX);
},{passive:true});

// tap anywhere once to enable audio (mobile autoplay rules)
document.addEventListener("pointerdown", ()=>{
  if(!started) initAudio();
},{passive:true});

document.getElementById("reset").addEventListener("click", ()=>{
  initAudio();
  value=0.40;
  hint.textContent="Drag to 0%â€¦";
  pop.classList.remove("show");
  render();
});

document.getElementById("menu").addEventListener("click", ()=>{
  // optional: fade sound quick on exit
  try{ if(gainNode) gainNode.gain.value = MIN_GAIN; }catch(e){}
  location.href=MAIN_PAGE_URL;
});

render();
</script>
</body>
</html>
